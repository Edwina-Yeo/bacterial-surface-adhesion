

figure1=figure('units','inch','position',[0,0,7,6 ...
    ]);

Vs=20
D_r_str='1'
beta=0.1
gam=logspace(-1.5,3,20); % Shear rates 
colour(1,:)=[1,0,0];
colour(2,:)=[0.392156862745098 0.831372549019608 0.0745098039215686];
colour(3,:)=[0.929411764705882 0.694117647058824 0.125490196078431];
colour(4,:)=[0 0.447058823529412 0.741176470588235]

i=1
for kappa=[1]
J=load("Adhesion_kappa/collision_rates_beta0.1_kappa"+string(kappa)+"_cellsPerSecond10000_totalCells10000000.csv")
J=load("Adhesion_kappa/collision_rates_beta0.1_kappa"+string(kappa)+"_cellsPerSecond10000_totalCells10000000.csv")

plot(gam,J(:,4),'.','Color',colour(i,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=$'+string(kappa));hold on
i=i+1
end

for kappa=[0.8:-0.2:0.4]
J=load("Adhesion_kappa/collision_rates_beta0.1_kappa"+string(kappa)+"_cellsPerSecond10000_totalCells10000000.csv")

plot(gam,J(:,4),'x','Color',colour(i,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=$'+string(kappa));hold on
i=i+1
end
set(gca,'Xscale','log') 
% set(gca,'Yscale','log')
xlabel('Fluid shear rate $\dot{\gamma} $ (s$^{-1}$)')
ylabel({"Net bacterial adhesion rate $\bar{J}$ (cells/s$^{-1}$)"})
legend(location='southwest')
ylim([2e-1,1e3])
ylim([8e2,9e7]./(2500*750))

  xlim([2e-2,2e1])
% Add scaling lines on top
loglog(gam(1:5),1e8*gam(1:5).^(1/3)./(2500*750),'k-.',HandleVisibility='off')
    loglog(gam(11:14),10e8*gam(11:14).^(-1 ...
    )./(2500*750),'k-.',HandleVisibility='off')

gam=logspace(-1.5,2,20); % Shear rates 

errorbar(gam,mean(B,1),std(B,1),'x',Color=colour(2,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=0.8$'); hold on
errorbar(gam,mean(A,1),std(A,1),'x',Color=colour(3,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=0.6$')

errorbar(gam,mean(C,1),std(C,1),'x',Color=colour(4,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=0.4$')


title('(a)')
 exportgraphics(figure1,'flux_kappa.pdf')

%%


gam=logspace(-1.5,2,20); % Shear rates 


figure1=figure('units','inch','position',[0,0,8,6 ...
    ]);% kappa=0.6
A(1,:)=[23.463568975802463
26.60516497301177
30.183646483328733
34.110049419520585
38.481856442787176
43.43618690568392
48.602109239653885
54.12418953846437
59.81018733200348
63.450024572368804
63.06748831056135
56.68819805349448
45.371383570118205
34.41957229961509
24.39006185011099
17.222686758981567
11.56400071022893
8.11740622797197
4.815787199468745
3.84]


A(2,:)=[23.47230951125517
26.593797921090648
30.138177037224015
34.070901321436956
38.54900163739092
43.37121982753921
48.737504180012614
54.20474248447181
60.09518419609225
63.72678233087535
62.62165428137209
56.794368311341046
45.77600840322429
34.039748473964984
24.65391971827702
17.33266560163151
11.317481315243429
7.2953904074178455
5.208378547251523
3.48]

A(3,:)=[23.47796366371155
26.59845686584063
30.11389121220902
34.08065448082112
38.530783413983535
43.27250361789074
48.64530667300643
54.26854435913825
59.92162600012802
63.66291515583538
63.49573519855973
55.89662486524602
45.81297920015784
34.061721753134826
24.898587923303705
17.200690990451577
11.676054980676884
7.877651613643684
5.548624381996596
3.52]

A(4,:)=[23.48072116983122
26.590086230667424
30.153097160864615
34.06990794409228
38.41616042504539
43.40317603643182
48.72122455027901
54.5097105185917
59.795881016501006
63.20836499113648
62.7412468414702
56.21379171147121
45.856111796580315
34.63616605143209
24.63952747092251
16.936741768091704
11.720876688856066
7.997528920807826
5.3130695733269295
3.72]

kappa=0.8

B(1,:)=[24.43163071135449
27.842762416784268
31.721364651887793
36.10321590811041
41.07346773091012
46.64847142862509
52.8211122919037
59.559665849333115
65.87870047896106
70.110622935096
69.10779195257538
60.88125127477663
48.752157556375096
36.685959093990114
25.915640069689136
17.46464021281145
12.527667436081341
8.54553946784391
5.365415086364634
3.52]

B(2,:)=[24.434350270142236
27.76317372161547
31.79900838441749
36.17686129216392
41.0708454108742
46.67409967536075
52.77630301402308
59.5911972777397
65.96115003409375
69.95181806742904
69.29949179155616
61.27770983255813
48.45844511406966
36.20568599213502
25.061700059988162
17.515963672714758
11.328686742288225
8.45991281986952
5.182205790732671
3.84]

B(3,:)=[24.407104085822226
27.807945987345597
31.753184400721313
36.05390826900162
41.10162316708517
46.64920969087674
52.760829306553504
59.26405870802143
65.76801477481035
69.92937824917176
68.93719668302367
61.344906198283795
48.05587421412656
36.1962688724908
26.088347037943265
18.351802876854343
11.743287542945657
8.905171389336338
5.784179190666263
4.0]

B(4,:)=[24.431693956907694
27.826871742159845
31.687269953509077
36.09025684911387
41.12301577790445
46.65374473042255
52.91717822577728
59.130542815862306
65.82486355483333
69.97253174582039
68.89674625828461
61.051930043719864
48.81582948442732
35.694022491465866
25.77171759614403
17.33999752447484
12.124272062468703
8.408536831084888
5.051342008138412
4.0]

C(1,:)=[21.74879229179956
24.453892401776802
27.36507263122325
30.569291334946723
34.03833514193447
38.022087950231004
42.03690529233058
46.437911185791506
50.85029252559839
53.46833310756306
53.4948073603554
49.03318807002551
40.79316654984689
31.47829193073781
23.60328566139773
15.807625650218924
11.956190656796771
7.860526284048807
6.019733999335931
3.32]
C(2,:)=[21.734296411005346
24.418554015872367
27.426643992940104
30.613045091628422
34.197813605171106
37.863677964235286
42.062694804779866
46.1487088658749
50.784784659876536
53.61678113603435
53.54932749804719
49.24418465840413
40.877377809528866
31.85183767662511
23.032393183002135
16.232877175132053
11.597616991363315
7.158387770658826
5.1036875211761155
3.52]

C(3,:)=[21.74559206680747
24.466921981699993
27.354377413880876
30.662759112378215
34.21616984542249
37.93233635363822
42.21517529713625
46.55738573873832
50.74901887112035
53.71114344870602
53.21517181542011
48.65151271270368
40.503561973867406
31.446901531923753
22.509474862454912
16.335524094938666
11.328686742288225
7.963278261618072
5.260724060289227
3.4]

C(4,:)=[21.773470706659516
24.48577040963042
27.394292437719397
30.659146831124822
34.17600694381984
37.96650734928577
42.05850400900685
46.6775993095384
50.53668303050467
53.82449329990308
53.793788760600684
48.61791452984083
40.78905868352094
30.8787353133893
22.854888798963167
15.98359179845884
10.858058806406815
7.75777430647954
5.862697460222819
3.88]


D(1,:)=[25.008088630581902
28.58651171705855
32.71418808717241
37.422872557005476
42.77369723208899
48.773928451109605
55.535619661643494
62.992157438530725
70.12767618319603
75.08017960915222
72.93035709041713
64.00453835370605
50.92521884280267
37.9666873656037
26.903907721365545
17.58195097830472
12.191504624737476
8.596915456628542
5.627142651553152
4.12]

D(2,:)=[25.02567089437244
28.64597609071394
32.779245735205286
37.48238489065509
42.82062295904742
48.81084156369183
55.52917228353118
62.72660368991905
69.95374150524489
74.66820756114663
73.1959229223997
64.3983090568585
51.05256269890712
37.059504839877405
26.07875220637359
18.388462491070996
12.124272062468703
8.579790127033665
5.44393335592119
4.16]

D(3,:)=[25.011870714663466
28.649436468764755
32.71613804392544
37.382821388608505
42.72131983979275
48.84733281213026
55.6582810302304
62.905692349697055
70.06141535350035
74.65957686181692
73.02356893872889
63.831171730133796
50.69723226171244
36.7864083701951
26.428963558666688
17.230018681824895
12.124272062468703
7.877651613643684
6.176770538449042
3.56]

D(4,:)=[25.028377804049544
28.629737445112337
32.75351221502516
37.376274128836734
42.77963195638079
48.765385702197726
55.69180739641447
63.01383529556025
70.40627285350737
74.39720360219324
73.0921587893734
64.42384367583425
50.98683683769192
37.483275223867196
26.275446253551905
18.417790182444314
12.30355889518543
8.151656887161725
4.711096173393337
3.4]
beta=0.1
D_r_str=1
Vs=22
colour=[]
colour(1,:)=[1,0,0];
colour(2,:)=[0.392156862745098 0.831372549019608 0.0745098039215686];
colour(3,:)=[0.929411764705882 0.694117647058824 0.125490196078431];
colour(4,:)=[0 0.447058823529412 0.741176470588235]

errorbar(gam,mean(D,1),std(D,1),'r.',LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=1$'); hold on

errorbar(gam,mean(B,1),std(B,1),'x',Color=colour(2,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=0.8$'); hold on
errorbar(gam,mean(A,1),std(A,1),'x',Color=colour(3,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=0.6$')

errorbar(gam,mean(C,1),std(C,1),'x',Color=colour(4,:),LineWidth=2,MarkerSize=20,DisplayName='$\mathcal{V}_s='+string(Vs)+'\mu$m/s, $D_r$='+D_r_str...
    +'s$^{-1}$, $\beta$='+string(beta)+', $\kappa=0.4$')


set(gca,'Xscale','log') 
set(gca,'Yscale','log')
xlabel('Fluid shear rate $\dot{\gamma} $ (s$^{-1}$)')
ylabel({"Net bacterial adhesion rate $J_A$ (cells/s$^{-1}$)"})
legend(location='southwest')
% Add scaling lines on top
loglog(gam(1:6),0.8e8*gam(1:6).^(1/3)./(2500*750),'k-.',HandleVisibility='off')
    loglog(gam(12:16),25e7./(2500*750)*gam(12:16).^(-1) ...
    ,'k-.',HandleVisibility='off')


title('(a)')
ii=18
ylim([3,1e2])
  xlim([2e-2,6e1])
 exportgraphics(figure1,'flux_kappa.pdf')


