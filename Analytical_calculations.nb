(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65407,       1929]
NotebookOptionsPosition[     60322,       1841]
NotebookOutlinePosition[     60723,       1857]
CellTagsIndexPosition[     60680,       1854]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
This notebook details analytical calculations to complement the paper \
\[OpenCurlyDoubleQuote]A shear-induced limit on bacterial surface adhesion in \
fluid flow\[CloseCurlyDoubleQuote]
Nematic order tensor and mean orientation vector calculations for continuum \
model
Author: Edwina Yeo, edwina.yeo.14@ucl.ac.uk

Section 1: Calculation of mean orientation vector and nematic order parameter \
far from surface [SI section 2]\
\>", "Chapter",
 CellChangeTimes->{{3.959051445117622*^9, 
  3.959051557353744*^9}},ExpressionUUID->"6fc8e4dd-4d0d-4d6f-8568-\
d0e74ea1e545"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Validate", " ", "that", " ", "there", " ", "is", " ", "zero", " ", "mean",
     " ", "orientation", " ", 
    RowBox[{"eq", ".", "S10"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "nx"}], "/", "per"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "+", 
           RowBox[{"b", "/", "4"}]}], ")"}], "ny"}]}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "ny"}], "/", "per"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "-", 
           RowBox[{"b", "/", "4"}]}], ")"}], "nx"}]}], "==", "0"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.959051859840121*^9, 3.959051896153691*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"03b7beb0-c04c-4985-a583-2c12137d0d6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"nx", "\[Rule]", "0"}], ",", 
    RowBox[{"ny", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.959051905764674*^9, 3.967029440299591*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"9b05c7ef-bebf-46c0-8924-6a03fb1e7915"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Q", " ", "tensor", " ", "solve"}], "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EE", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "}"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Rate", " ", "of", " ", "strain"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}]}], "}"}]}], ";"}],
    " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Rate", " ", "of", " ", "rotation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q11", ",", "Q12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Q12", ",", "Q22"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Q", " ", "tensor"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ppppE", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Q12", "/", "2"}], ",", " ", 
         RowBox[{"1", "/", "8"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "8"}], ",", 
         RowBox[{"Q12", "/", "2"}]}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Closure", " ", "for", " ", 
     RowBox[{"pppp", ":", "E"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Eq", " ", "S13"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"EQ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"b", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"EE", ".", 
          RowBox[{"(", 
           RowBox[{"Q", "+", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "2", "]"}], "/", "2"}]}], ")"}]}],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Q", "+", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "2", "]"}], "/", "2"}]}], ")"}], 
          ".", "EE"}]}], ")"}]}], "+", 
      RowBox[{"W", ".", 
       RowBox[{"(", "Q", ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", "Q", ")"}], ".", "W"}], "-", 
      RowBox[{"2", "*", "b", "*", "ppppE"}], "-", 
      RowBox[{
       RowBox[{"4", "/", "Per"}], "*", "Q"}]}], "//", "FullSimplify"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Solve", " ", "algebraic", " ", "equations", " ", "to", " ", "give", " ", 
     
     RowBox[{"eq", ".", "S16"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"4", " ", "Q11"}], "Per"]}], "+", "Q12"}], "==", "0"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"4", " ", "Q12"}], "Per"]}], "+", 
         RowBox[{
          FractionBox["1", "4"], " ", 
          RowBox[{"(", 
           RowBox[{"b", "-", 
            RowBox[{"2", " ", "Q11"}], "+", 
            RowBox[{"2", " ", "b", " ", "Q11"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "b"}], ")"}], " ", "Q22"}]}], ")"}]}]}], "==",
         "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Q12"}], "-", 
         FractionBox[
          RowBox[{"4", " ", "Q22"}], "Per"]}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q12", ",", "Q22"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.959051586439352*^9, 3.9590516556932693`*^9}, {
   3.959051692310526*^9, 3.959051850413486*^9}, 3.95905196662355*^9, {
   3.967025588480133*^9, 3.967025593843396*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"286f239b-cfe2-422d-a9f7-b6776150bd13"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "Q11"}], "Per"]}], "+", "Q12"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "Q12"}], "Per"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", 
         RowBox[{"2", " ", "Q11"}], "+", 
         RowBox[{"2", " ", "b", " ", "Q11"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "b"}], ")"}], " ", "Q22"}]}], ")"}]}]}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "Q12"}], "Per"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", 
         RowBox[{"2", " ", "Q11"}], "+", 
         RowBox[{"2", " ", "b", " ", "Q11"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "b"}], ")"}], " ", "Q22"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"-", "Q12"}], "-", 
      FractionBox[
       RowBox[{"4", " ", "Q22"}], "Per"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.95905161335654*^9, {3.959051766838269*^9, 3.959051805325362*^9}, {
   3.95905196143554*^9, 3.9590519675718117`*^9}, 3.967023618036727*^9, 
   3.9670273237961197`*^9, 3.96702847996381*^9, 3.9670294424078493`*^9, 
   3.967114152283959*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"9e057bbf-0533-45f7-9b81-c62ca0412fb5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Q11", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", 
       SuperscriptBox["Per", "2"]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"16", "+", 
         SuperscriptBox["Per", "2"]}], ")"}]}]]}], ",", 
    RowBox[{"Q12", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", "Per"}], 
      RowBox[{"16", "+", 
       SuperscriptBox["Per", "2"]}]]}], ",", 
    RowBox[{"Q22", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", " ", 
        SuperscriptBox["Per", "2"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"16", "+", 
          SuperscriptBox["Per", "2"]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.95905161335654*^9, {3.959051766838269*^9, 3.959051805325362*^9}, {
   3.95905196143554*^9, 3.9590519675718117`*^9}, 3.967023618036727*^9, 
   3.9670273237961197`*^9, 3.96702847996381*^9, 3.9670294424078493`*^9, 
   3.9671141522873163`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"2c0db9d0-4a22-4776-bebf-d8c4b76cfc8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Q11", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", 
       SuperscriptBox["Per", "2"]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"16", "+", 
         SuperscriptBox["Per", "2"]}], ")"}]}]]}], ",", 
    RowBox[{"Q12", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", "Per"}], 
      RowBox[{"16", "+", 
       SuperscriptBox["Per", "2"]}]]}], ",", 
    RowBox[{"Q22", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", " ", 
        SuperscriptBox["Per", "2"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"16", "+", 
          SuperscriptBox["Per", "2"]}], ")"}]}]]}]}]}], "}"}], "}"}]], "Input",\

 CellChangeTimes->{3.967114147694355*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"bdb76d07-9e5f-49ab-be0a-695d34c9f0ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Q11", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", 
       SuperscriptBox["Per", "2"]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"16", "+", 
         SuperscriptBox["Per", "2"]}], ")"}]}]]}], ",", 
    RowBox[{"Q12", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", "Per"}], 
      RowBox[{"16", "+", 
       SuperscriptBox["Per", "2"]}]]}], ",", 
    RowBox[{"Q22", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", " ", 
        SuperscriptBox["Per", "2"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"16", "+", 
          SuperscriptBox["Per", "2"]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.967114147747395*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"c13a70aa-58cd-411e-b3f3-374218721a45"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9590519126804113`*^9, 
  3.95905193001649*^9}},ExpressionUUID->"2a9aefcb-8ce6-4ba9-acfc-\
eb5c05ba2e43"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Section 2: Calculation of mean orientation vector in boundary layer [SI \
section 4]\
\>", "Chapter",
 CellChangeTimes->{{3.959051930431294*^9, 
  3.959051958833153*^9}},ExpressionUUID->"fdc42be3-76ce-44e5-9c2e-\
9af1868d4faa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"eq", ".", " ", "S30"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "nx"}], "/", "per"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "+", 
             RowBox[{"b", "/", "4"}]}], ")"}], "ny"}], "-", 
          RowBox[{"Vs", "*", "Qxy", "*", "A"}]}], "==", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "ny"}], "/", "per"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "-", 
             RowBox[{"b", "/", "4"}]}], ")"}], "nx"}], "-", 
          RowBox[{"Vs", "*", 
           RowBox[{"(", 
            RowBox[{"Qyy", "+", 
             RowBox[{"1", "/", "2"}]}], ")"}], "*", "A"}]}], "==", "0"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nx", ",", "ny"}], "}"}]}], "]"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Here", " ", "A"}], "=", 
     RowBox[{
      RowBox[{"1", "/", "eps"}], " ", "d", "\\r", 
      RowBox[{"ho", "/", "dy"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify"}], " ", 
   RowBox[{"(*", 
    RowBox[{"nx", ",", " ", 
     RowBox[{"eq", " ", "S31"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify", " ", 
    RowBox[{"(*", 
     RowBox[{"ny", " ", "eq", " ", "S31"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.959051998712936*^9, 3.9590520327986727`*^9}, {
  3.959052156550576*^9, 3.959052207269649*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"ded22f65-96f8-4e2d-8c2f-6b3cf4e3d088"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"nx", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", "per", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "A", " ", "per", " ", "Vs"}], "+", 
         RowBox[{"A", " ", "b", " ", "per", " ", "Vs"}], "+", 
         RowBox[{"8", " ", "A", " ", "Qxy", " ", "Vs"}], "+", 
         RowBox[{"4", " ", "A", " ", "per", " ", "Qyy", " ", "Vs"}], "+", 
         RowBox[{
         "2", " ", "A", " ", "b", " ", "per", " ", "Qyy", " ", "Vs"}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"-", "16"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["per", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["per", "2"]}]}]]}], ",", 
    RowBox[{"ny", "\[Rule]", 
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "A", " ", "per", " ", "Vs"}], "-", 
         RowBox[{"2", " ", "A", " ", 
          SuperscriptBox["per", "2"], " ", "Qxy", " ", "Vs"}], "+", 
         RowBox[{"A", " ", "b", " ", 
          SuperscriptBox["per", "2"], " ", "Qxy", " ", "Vs"}], "+", 
         RowBox[{"4", " ", "A", " ", "per", " ", "Qyy", " ", "Vs"}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"-", "16"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["per", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["per", "2"]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9590519924312677`*^9, 3.959052058743061*^9, {3.959052164178154*^9, 
   3.959052208008925*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"f5423acc-7c7c-419d-89e1-35280f10871d"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "A", " ", "per", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", "Qxy"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", "b"}], ")"}], " ", "per", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "Qyy"}]}], ")"}]}]}], ")"}], " ", "Vs"}], 
  RowBox[{
   RowBox[{"-", "16"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      SuperscriptBox["b", "2"]}], ")"}], " ", 
    SuperscriptBox["per", "2"]}]}]]], "Output",
 CellChangeTimes->{
  3.9590519924312677`*^9, 3.959052058743061*^9, {3.959052164178154*^9, 
   3.959052208010047*^9}},
 CellLabel->"Out[15]=",ExpressionUUID->"02aaa0db-9ef4-4e54-bc0d-2d90f7efbafb"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "A", " ", "per", " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "b"}], ")"}], " ", "per", " ", "Qxy"}], "+", 
     
     RowBox[{"4", " ", "Qyy"}]}], ")"}], " ", "Vs"}], 
  RowBox[{
   RowBox[{"-", "16"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", 
      SuperscriptBox["b", "2"]}], ")"}], " ", 
    SuperscriptBox["per", "2"]}]}]]], "Output",
 CellChangeTimes->{
  3.9590519924312677`*^9, 3.959052058743061*^9, {3.959052164178154*^9, 
   3.959052208010993*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"496f36fd-bffb-4b35-af92-b19af0d33941"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "insert", " ", "values", " ", "of", " ", "the", " ", "nematic",
     " ", "order", " ", "tensor", " ", "from", " ", "above"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Qyy", "=", 
     FractionBox[
      RowBox[{"b", " ", 
       SuperscriptBox["per", "2"]}], 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"16", "+", 
         SuperscriptBox["per", "2"]}], ")"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Qxy", "=", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", " ", "per"}], 
       RowBox[{" ", 
        RowBox[{"(", 
         RowBox[{"16", "+", 
          SuperscriptBox["per", "2"]}], ")"}]}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify"}], " ", 
   RowBox[{"(*", 
    RowBox[{"nx", ",", " ", 
     RowBox[{"eq", " ", "S32"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify", " ", 
    RowBox[{"(*", 
     RowBox[{"ny", " ", "eq", " ", "S32"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.959052068742349*^9, 3.959052097964121*^9}, {
  3.959052276786477*^9, 3.959052286115751*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"359c2df2-f60a-46bd-b285-2477c8132eb3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"A", " ", 
   SuperscriptBox["per", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"16", " ", 
      RowBox[{"(", 
       RowBox[{"4", "+", "b"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "+", "b"}], ")"}], "2"], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}], " ", "Vs"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", "+", 
     SuperscriptBox["per", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        SuperscriptBox["b", "2"]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.959052100982312*^9, {3.959052255382478*^9, 3.959052286336053*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"970be2d7-4828-4985-8627-8b282f96b0d5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "A", " ", "per", " ", 
   RowBox[{"(", 
    RowBox[{"32", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "b"}], ")"}], " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}], " ", "Vs"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", "+", 
     SuperscriptBox["per", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        SuperscriptBox["b", "2"]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.959052100982312*^9, {3.959052255382478*^9, 3.959052286337057*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"56d3b1fb-0d4d-4220-bd94-53fd12f4f019"]
}, Open  ]],

Cell["\<\


Defining the Effective Peclet number \
\>", "Text",
 CellChangeTimes->{{3.959052452795063*^9, 3.959052459683766*^9}, {
  3.959052562943428*^9, 
  3.9590525630624723`*^9}},ExpressionUUID->"b1853518-378f-4b07-85bc-\
92c140d1af57"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.959052558499146*^9, 
  3.9590525595190907`*^9}},ExpressionUUID->"834b8f3e-31fd-4499-ae09-\
54ae8a3485fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"-", "1"}]}], "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "set", " ", "gradient", " ", "to", " ", "be", " ", "equal", " ", "to"}], 
    " ", "-", 
    RowBox[{
    "1", " ", "to", " ", "account", " ", "for", " ", "minus", " ", "in", " ", 
     "eq", " ", "S33"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Peeff", "[", 
    RowBox[{"Vs_", ",", "per_", ",", "b_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", "Vs"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], "//", "FullSimplify"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"eq", " ", "S33"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Peeff", "[", 
    RowBox[{"Vs_", ",", "per_", ",", "b_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"16", "+", 
        SuperscriptBox["per", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"16", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "-", 
           SuperscriptBox["b", "2"]}], ")"}], " ", 
         SuperscriptBox["per", "2"]}]}], ")"}]}], 
     RowBox[{"4", " ", "per", " ", 
      RowBox[{"(", 
       RowBox[{"32", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "-", "b"}], ")"}], " ", "b"}]}], ")"}], " ", 
         SuperscriptBox["per", "2"]}]}], ")"}], " ", 
      SuperscriptBox["Vs", "2"]}]], "//", "FullSimplify"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Manually", " ", "removing", " ", "a", " ", "minus", " ", "from", " ", 
    "top", " ", "and", " ", "bottom"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Peeff", "[", 
   RowBox[{"Vs", ",", "per", ",", "0"}], "]"}], "//", "FullSimplify", " ", 
  RowBox[{"(*", 
   RowBox[{
   "Confirm", " ", "value", " ", "for", " ", "circular", " ", "bacteria"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9590524714792624`*^9, 3.959052576603194*^9}, {
  3.9590526864848127`*^9, 
  3.959052797115449*^9}},ExpressionUUID->"b3dbe012-dc4e-45c7-8ed7-\
d8767455d15d"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.959052468480588*^9, 3.959052531459483*^9}, 
   3.959052566781971*^9, {3.9590526987295637`*^9, 3.95905277943923*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"6f13eeca-7d2c-4739-bb4a-c6aa350cff00"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", "+", 
     SuperscriptBox["per", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        SuperscriptBox["b", "2"]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}]}], 
  RowBox[{"4", " ", "per", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "32"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "b"}], ")"}], " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}], " ", 
   SuperscriptBox["Vs", "2"]}]]], "Output",
 CellChangeTimes->{{3.959052468480588*^9, 3.959052531459483*^9}, 
   3.959052566781971*^9, {3.9590526987295637`*^9, 3.959052779440104*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"5dfc583c-4083-4249-8ad7-2d8f817bd81f"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", "+", 
     SuperscriptBox["per", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "16"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        SuperscriptBox["b", "2"]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}]}], 
  RowBox[{"4", " ", "per", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "32"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "b"}], ")"}], " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["per", "2"]}]}], ")"}], " ", 
   SuperscriptBox["Vs", "2"]}]]], "Output",
 CellChangeTimes->{{3.959052468480588*^9, 3.959052531459483*^9}, 
   3.959052566781971*^9, {3.9590526987295637`*^9, 3.959052779441202*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"cbd954ff-5cd7-493c-86ee-50f83be5d2d9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", "+", 
   SuperscriptBox["per", "2"]}], 
  RowBox[{"2", " ", "per", " ", 
   SuperscriptBox["Vs", "2"]}]]], "Output",
 CellChangeTimes->{{3.959052468480588*^9, 3.959052531459483*^9}, 
   3.959052566781971*^9, {3.9590526987295637`*^9, 3.959052779442071*^9}},
 CellLabel->"Out[67]=",ExpressionUUID->"147e6291-c3fc-49c8-b7a9-95142e9ab389"]
}, Open  ]],

Cell["Defining  the Dimensional diffusion coeff ", "Text",
 CellChangeTimes->{{3.959052805558634*^9, 
  3.959052824686432*^9}},ExpressionUUID->"55e4dde9-ba54-413c-a0a5-\
8d8492e84e64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Peeff", "[", 
    RowBox[{"b", ",", 
     RowBox[{"gam", "/", "dr"}], ",", 
     RowBox[{"V", "/", 
      RowBox[{"(", 
       RowBox[{"gam", " ", "L"}], ")"}]}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"gam", "*", "L", "*", "L"}], ")"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{3.959052847507452*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"77db7cf5-47d4-46e1-bda6-75abd30d26ad"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"16", " ", 
      SuperscriptBox["dr", "2"]}], "+", 
     SuperscriptBox["gam", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["dr", "2"]}], "+", 
        SuperscriptBox["gam", "2"]}], ")"}], " ", 
      SuperscriptBox["L", "2"]}], "-", 
     SuperscriptBox["V", "2"]}], ")"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["b", "2"], " ", "dr", " ", 
   SuperscriptBox["gam", "2"], " ", 
   SuperscriptBox["L", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"16", " ", 
         SuperscriptBox["dr", "2"]}], "+", 
        SuperscriptBox["gam", "2"]}], ")"}], " ", 
      SuperscriptBox["L", "2"]}], "+", 
     RowBox[{"3", " ", "gam", " ", "L", " ", "V"}], "-", 
     SuperscriptBox["V", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.959052848079616*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"5746a029-0d64-453d-a0a1-74f1eac18b7b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Section 3: 3D analysis for SI Section VI", "Chapter",
 CellChangeTimes->{{3.967181938732004*^9, 3.967181940687607*^9}, {
   3.9711544642487087`*^9, 3.971154481243265*^9}, 
   3.971154629544058*^9},ExpressionUUID->"88a14906-b9e7-40ac-b6ab-\
8284cdbe1d3a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Q", " ", "tensor", " ", "solve"}], "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EE", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"Rate", " ", "of", " ", "strain"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Rate", " ", "of", " ", "rotation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q11", ",", "Q12", ",", "Q13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Q12", ",", "Q22", ",", "Q23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Q13", ",", "Q23", ",", "Q33"}], "}"}]}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"Nematic", " ", "order", " ", "tensor"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ppppE", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "15"}], ")"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "7"}], ")"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", " ", "Q12"}], ",", 
           RowBox[{"Q11", "+", "Q22"}], ",", "Q23"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q11", "+", "Q22"}], ",", 
           RowBox[{"3", " ", "Q12"}], ",", "Q13"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Q23", ",", "Q13", ",", "Q12"}], "}"}]}], "}"}]}]}]}], " ", 
    ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Harmonic", " ", "closure"}], "  ", "<", "pppp", ">"}], ":", 
     "EE"}], "  ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "First", " ", "solving", " ", "for", " ", "Q", " ", "in", " ", "the", " ", 
     RowBox[{"outer", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"b", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"EE", ".", 
           RowBox[{"(", 
            RowBox[{"Q", "+", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "3", "]"}], "/", "3"}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Q", "+", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "3", "]"}], "/", "3"}]}], ")"}], 
           ".", "EE"}]}], ")"}]}], "+", 
       RowBox[{"W", ".", 
        RowBox[{"(", "Q", ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", "Q", ")"}], ".", "W"}], "-", 
       RowBox[{"2", "*", "b", "*", "ppppE"}], "-", 
       RowBox[{
        RowBox[{"6", "/", "Per"}], "*", "Q"}]}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Solve", " ", "algebraic", " ", "equations", " ", "to", " ", "give", " ", 
     
     RowBox[{"eq", ".", "S41"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Reduce", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q23", ",", "Q31"}], "}"}]}], "]"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Gives", " ", "Q23", " ", "and", " ", "Q31"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q12", ",", "Q22"}], "}"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Gives", " ", "Q11"}], ",", "Q12", ",", "Q22"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"EQ", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"Q12", "==", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"294", " ", "b", " ", "Per"}], 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1764"}], "-", 
             RowBox[{"49", " ", 
              SuperscriptBox["Per", "2"]}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"], " ", 
              SuperscriptBox["Per", "2"]}]}], ")"}]}]]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q33", ",", "Q12"}], "}"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{"Gives", " ", "Q33"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",\

 CellChangeTimes->{{3.967182003479268*^9, 3.967182033329248*^9}, {
   3.967182240156971*^9, 3.967182377321505*^9}, {3.967182468703628*^9, 
   3.967182516236058*^9}, {3.967182615159259*^9, 3.967182647461529*^9}, {
   3.967182710758906*^9, 3.967182769517228*^9}, {3.967182810905447*^9, 
   3.967182851237494*^9}, {3.967182908906732*^9, 3.967182925131892*^9}, {
   3.967183014115712*^9, 3.967183030928054*^9}, {3.96718306139298*^9, 
   3.967183106897352*^9}, {3.96718315469781*^9, 3.96718315987661*^9}, {
   3.967183205522582*^9, 3.967183216358474*^9}, {3.967183287059575*^9, 
   3.96718330366731*^9}, 3.96718337509222*^9, {3.967183597349326*^9, 
   3.967183599505552*^9}, {3.96718368500471*^9, 3.9671837224167976`*^9}, {
   3.967189839899615*^9, 3.967189872309386*^9}, {3.967190127104418*^9, 
   3.967190130143699*^9}, {3.967190375144683*^9, 3.967190377414035*^9}, {
   3.9711546409716597`*^9, 3.971154769647243*^9}, {3.971154858946789*^9, 
   3.971154914306979*^9}, 3.971155214844455*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"8c781a94-3767-47fe-ba34-fa35976226ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Q13", "\[Equal]", "0"}], "&&", 
    RowBox[{"Q23", "\[Equal]", "0"}], "&&", 
    RowBox[{"Per", "\[NotEqual]", "0"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Per", " ", "Q13"}], "\[NotEqual]", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", "\[Equal]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"7", " ", 
          SqrtBox[
           RowBox[{"144", "+", 
            SuperscriptBox["Per", "2"]}]]}], 
         RowBox[{"3", " ", "Per"}]]}]}], "||", 
      RowBox[{"b", "\[Equal]", 
       FractionBox[
        RowBox[{"7", " ", 
         SqrtBox[
          RowBox[{"144", "+", 
           SuperscriptBox["Per", "2"]}]]}], 
        RowBox[{"3", " ", "Per"}]]}]}], ")"}], "&&", 
    RowBox[{"Q23", "\[Equal]", 
     RowBox[{
      FractionBox["1", "84"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "7"}], "+", 
        RowBox[{"3", " ", "b"}]}], ")"}], " ", "Per", " ", "Q13"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.967182497494597*^9, 3.967182516524706*^9}, {
   3.9671826197826014`*^9, 3.9671826477467966`*^9}, {3.96718274197936*^9, 
   3.967182770417581*^9}, {3.967182812023607*^9, 3.967182852118461*^9}, {
   3.9671829176758637`*^9, 3.967182935030932*^9}, {3.967183020606628*^9, 
   3.967183031508387*^9}, 3.967183065077834*^9, 3.967183107224068*^9, {
   3.967183156325095*^9, 3.967183160236765*^9}, 3.967183217287719*^9, 
   3.967183304010215*^9, 3.967183375920892*^9, 3.967183599949273*^9, {
   3.967183686201255*^9, 3.96718372285463*^9}, {3.967189854615435*^9, 
   3.9671898726326537`*^9}, 3.967190130840724*^9, 3.967190377962883*^9, 
   3.968997357536339*^9, 3.970810364721593*^9, 3.970810398079351*^9, {
   3.971154719788025*^9, 3.971154725979865*^9}, {3.971154765040563*^9, 
   3.971154769896727*^9}, {3.971154876994226*^9, 3.9711548988781567`*^9}, 
   3.971155215642214*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"60af0f5d-7b4f-4554-bf4a-b0ec65aef10c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Q11", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"7", " ", "b", " ", 
        RowBox[{"(", 
         RowBox[{"7", "+", "b"}], ")"}], " ", 
        SuperscriptBox["Per", "2"]}], 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1764"}], "-", 
          RowBox[{"49", " ", 
           SuperscriptBox["Per", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["Per", "2"]}]}], ")"}]}]]}]}], ",", 
    RowBox[{"Q12", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"294", " ", "b", " ", "Per"}], 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1764"}], "-", 
          RowBox[{"49", " ", 
           SuperscriptBox["Per", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["Per", "2"]}]}], ")"}]}]]}]}], ",", 
    RowBox[{"Q22", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"7", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "7"}], "+", "b"}], ")"}], " ", "b", " ", 
        SuperscriptBox["Per", "2"]}], 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1764"}], "-", 
          RowBox[{"49", " ", 
           SuperscriptBox["Per", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["Per", "2"]}]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.967182497494597*^9, 3.967182516524706*^9}, {
   3.9671826197826014`*^9, 3.9671826477467966`*^9}, {3.96718274197936*^9, 
   3.967182770417581*^9}, {3.967182812023607*^9, 3.967182852118461*^9}, {
   3.9671829176758637`*^9, 3.967182935030932*^9}, {3.967183020606628*^9, 
   3.967183031508387*^9}, 3.967183065077834*^9, 3.967183107224068*^9, {
   3.967183156325095*^9, 3.967183160236765*^9}, 3.967183217287719*^9, 
   3.967183304010215*^9, 3.967183375920892*^9, 3.967183599949273*^9, {
   3.967183686201255*^9, 3.96718372285463*^9}, {3.967189854615435*^9, 
   3.9671898726326537`*^9}, 3.967190130840724*^9, 3.967190377962883*^9, 
   3.968997357536339*^9, 3.970810364721593*^9, 3.970810398079351*^9, {
   3.971154719788025*^9, 3.971154725979865*^9}, {3.971154765040563*^9, 
   3.971154769896727*^9}, {3.971154876994226*^9, 3.9711548988781567`*^9}, 
   3.971155215643227*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"fec760e9-119c-40fc-a28b-a6d78fc8505a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Q33", "\[Rule]", 
     FractionBox[
      RowBox[{"14", " ", 
       SuperscriptBox["b", "2"], " ", 
       SuperscriptBox["Per", "2"]}], 
      RowBox[{"5", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1764"}], "-", 
         RowBox[{"49", " ", 
          SuperscriptBox["Per", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["Per", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"Q12", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"294", " ", "b", " ", "Per"}], 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1764"}], "-", 
          RowBox[{"49", " ", 
           SuperscriptBox["Per", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["Per", "2"]}]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.967182497494597*^9, 3.967182516524706*^9}, {
   3.9671826197826014`*^9, 3.9671826477467966`*^9}, {3.96718274197936*^9, 
   3.967182770417581*^9}, {3.967182812023607*^9, 3.967182852118461*^9}, {
   3.9671829176758637`*^9, 3.967182935030932*^9}, {3.967183020606628*^9, 
   3.967183031508387*^9}, 3.967183065077834*^9, 3.967183107224068*^9, {
   3.967183156325095*^9, 3.967183160236765*^9}, 3.967183217287719*^9, 
   3.967183304010215*^9, 3.967183375920892*^9, 3.967183599949273*^9, {
   3.967183686201255*^9, 3.96718372285463*^9}, {3.967189854615435*^9, 
   3.9671898726326537`*^9}, 3.967190130840724*^9, 3.967190377962883*^9, 
   3.968997357536339*^9, 3.970810364721593*^9, 3.970810398079351*^9, {
   3.971154719788025*^9, 3.971154725979865*^9}, {3.971154765040563*^9, 
   3.971154769896727*^9}, {3.971154876994226*^9, 3.9711548988781567`*^9}, 
   3.971155215644013*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"7d3c320e-6900-4379-8a54-17229fb79ee9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Validate", " ", "that", " ", "there", " ", "is", " ", "zero", " ", "mean",
     " ", "orientation", " ", "in", " ", "the", " ", 
    RowBox[{"outer", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "*", 
         RowBox[{"nx", "/", "per"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "+", 
           RowBox[{"3", 
            RowBox[{"b", "/", "10"}]}]}], ")"}], "ny"}]}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "*", 
         RowBox[{"ny", "/", "per"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "-", 
           RowBox[{"3", 
            RowBox[{"b", "/", "10"}]}]}], ")"}], "nx"}]}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{"nz", "/", "per"}]}], "==", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.967184493230364*^9, 3.96718450109649*^9}, {
  3.967189475652792*^9, 3.967189508783796*^9}, {3.967191670924892*^9, 
  3.967191697998952*^9}, {3.968992092259115*^9, 3.9689920971862288`*^9}, {
  3.971155335345193*^9, 
  3.9711553378883123`*^9}},ExpressionUUID->"267bcc46-0f4a-441d-9562-\
3a88765d5643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"nx", "\[Rule]", "0"}], ",", 
    RowBox[{"ny", "\[Rule]", "0"}], ",", 
    RowBox[{"nz", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.967184295715807*^9, {3.967189506589493*^9, 3.967189509141006*^9}, 
   3.968992099314559*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"36ba0038-0f7f-425e-88cd-ec7cb691b9b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Boundary", " ", "layer", " ", "equations", " ", 
    RowBox[{"Eq", ".", " ", 
     RowBox[{"(", "S43", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"nx", "/", "per"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "+", 
             RowBox[{"3", 
              RowBox[{"b", "/", "10"}]}]}], ")"}], "ny"}], "-", 
          RowBox[{"A", " ", "Qxy"}]}], "==", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"ny", "/", "per"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "-", 
             RowBox[{"3", 
              RowBox[{"b", "/", "10"}]}]}], ")"}], "nx"}], "-", 
          RowBox[{"A", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "3"}], "+", "Qyy"}], ")"}]}]}], "==", "0"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nx", ",", "ny"}], "}"}]}], "]"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Here", " ", "A"}], "=", 
     RowBox[{
      RowBox[{"1", "/", "eps"}], " ", "d", "\\r", 
      RowBox[{"ho", "/", "dy"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify"}], " ", 
   RowBox[{"(*", 
    RowBox[{"nx", ",", " ", 
     RowBox[{"eq", " ", "S44"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify", " ", 
    RowBox[{"(*", 
     RowBox[{"ny", " ", "eq", " ", "S44"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.967191603440181*^9, 3.967191607405212*^9}, {
  3.967191700178316*^9, 3.9671917232326326`*^9}, {3.968992102141648*^9, 
  3.9689921039083147`*^9}, {3.968997282612561*^9, 3.968997299507946*^9}, {
  3.9711554432608833`*^9, 3.971155488319656*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"8ef67c33-08d2-46ec-a2b1-c00751d0a138"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"nx", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "A", " ", 
        SuperscriptBox["per", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"44100", "+", 
          RowBox[{"44100", " ", "b"}], "+", 
          RowBox[{"1225", " ", 
           SuperscriptBox["per", "2"]}], "-", 
          RowBox[{"411", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["per", "2"]}], "+", 
          RowBox[{"18", " ", 
           SuperscriptBox["b", "3"], " ", 
           SuperscriptBox["per", "2"]}]}], ")"}]}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1764"}], "-", 
          RowBox[{"49", " ", 
           SuperscriptBox["per", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["per", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "400"}], "-", 
          RowBox[{"25", " ", 
           SuperscriptBox["per", "2"]}], "+", 
          RowBox[{"9", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["per", "2"]}]}], ")"}]}]]}]}], ",", 
    RowBox[{"ny", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", "A", " ", "per", " ", 
        RowBox[{"(", 
         RowBox[{"88200", "+", 
          RowBox[{"2450", " ", 
           SuperscriptBox["per", "2"]}], "-", 
          RowBox[{"3675", " ", "b", " ", 
           SuperscriptBox["per", "2"]}], "+", 
          RowBox[{"1383", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["per", "2"]}]}], ")"}]}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1764"}], "-", 
          RowBox[{"49", " ", 
           SuperscriptBox["per", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["per", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "400"}], "-", 
          RowBox[{"25", " ", 
           SuperscriptBox["per", "2"]}], "+", 
          RowBox[{"9", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["per", "2"]}]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.967191608235196*^9, 3.9671917238009796`*^9, 3.968992108027813*^9, 
   3.96899340889693*^9, {3.968997284609977*^9, 3.9689973001113873`*^9}, {
   3.968997331640779*^9, 3.96899735788202*^9}, 3.969004867035297*^9, 
   3.97081036894219*^9, 3.9708104200298367`*^9, {3.971155474663889*^9, 
   3.971155491538522*^9}},
 CellLabel->
  "Out[128]=",ExpressionUUID->"5fc9000d-035b-47c1-85bc-15ae04909e38"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"88200", " ", "A", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", 
     SuperscriptBox["per", "2"]}], "+", 
    RowBox[{"2", " ", "A", " ", 
     RowBox[{"(", 
      RowBox[{"1225", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "137"}], "+", 
          RowBox[{"6", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["per", "4"]}]}], 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1764"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "49"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "400"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "25"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.967191608235196*^9, 3.9671917238009796`*^9, 3.968992108027813*^9, 
   3.96899340889693*^9, {3.968997284609977*^9, 3.9689973001113873`*^9}, {
   3.968997331640779*^9, 3.96899735788202*^9}, 3.969004867035297*^9, 
   3.97081036894219*^9, 3.9708104200298367`*^9, {3.971155474663889*^9, 
   3.971155491581203*^9}},
 CellLabel->
  "Out[129]=",ExpressionUUID->"c410b604-d2e9-42a3-a471-5284c6d5f6d2"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "A", " ", "per", " ", 
    RowBox[{"(", 
     RowBox[{"88200", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2450", "+", 
         RowBox[{"3", " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1225"}], "+", 
            RowBox[{"461", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}]}], 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1764"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "49"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "400"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "25"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.967191608235196*^9, 3.9671917238009796`*^9, 3.968992108027813*^9, 
   3.96899340889693*^9, {3.968997284609977*^9, 3.9689973001113873`*^9}, {
   3.968997331640779*^9, 3.96899735788202*^9}, 3.969004867035297*^9, 
   3.97081036894219*^9, 3.9708104200298367`*^9, {3.971155474663889*^9, 
   3.971155491606422*^9}},
 CellLabel->
  "Out[130]=",ExpressionUUID->"166c631d-8df8-4bf1-8715-a603dfc15d0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Qyy", "=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"7", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "7"}], "+", "b"}], ")"}], " ", "b", " ", 
       SuperscriptBox["per", "2"]}], 
      RowBox[{"5", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1764"}], "-", 
         RowBox[{"49", " ", 
          SuperscriptBox["per", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["per", "2"]}]}], ")"}]}]]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Insert", " ", "defintion", " ", "of", " ", "Q", " ", "tensor", " ", 
    "components", " ", "from", " ", "above"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qxy", "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"294", " ", "b", " ", "per"}], 
     RowBox[{"5", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1764"}], "-", 
        RowBox[{"49", " ", 
         SuperscriptBox["per", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["b", "2"], " ", 
         SuperscriptBox["per", "2"]}]}], ")"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify"}], " ", 
  RowBox[{"(*", 
   RowBox[{"nx", ",", " ", 
    RowBox[{"eq", " ", "S45"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "//", "FullSimplify", " ", 
  RowBox[{"(*", 
   RowBox[{"ny", " ", "eq", " ", "S46"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.967192192598708*^9, 3.9671922055649176`*^9}, {
  3.967192529157363*^9, 3.96719253838033*^9}, {3.971155503176403*^9, 
  3.97115552495894*^9}},ExpressionUUID->"195c06f1-c592-4d5f-8d33-\
5ab3ed2323c4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"88200", " ", "A", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", 
     SuperscriptBox["per", "2"]}], "+", 
    RowBox[{"2", " ", "A", " ", 
     RowBox[{"(", 
      RowBox[{"1225", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "137"}], "+", 
          RowBox[{"6", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["per", "4"]}]}], 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1764"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "49"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "400"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "25"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.967192206394527*^9, 3.967192539080709*^9, {3.968993413059529*^9, 
   3.968993415115922*^9}, 3.9690018566225357`*^9, {3.969004861870208*^9, 
   3.9690048640001698`*^9}, 3.9708104868632107`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"3d0adde3-b1cb-4646-9c65-d535b1945c29"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "A", " ", "per", " ", 
    RowBox[{"(", 
     RowBox[{"88200", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2450", "+", 
         RowBox[{"3", " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1225"}], "+", 
            RowBox[{"461", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}]}], 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1764"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "49"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "400"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "25"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["per", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.967192206394527*^9, 3.967192539080709*^9, {3.968993413059529*^9, 
   3.968993415115922*^9}, 3.9690018566225357`*^9, {3.969004861870208*^9, 
   3.9690048640001698`*^9}, 3.970810486888756*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"fd58c17f-4077-4f7a-8ee7-d621b344f32e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{
      RowBox[{
       RowBox[{"sol", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{"b", "->", "0"}], "}"}]}], "//", "FullSimplify"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Spherical", " ", "bacterial", " ", "limit"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"16", "+", 
        SuperscriptBox["per", "2"]}], ")"}]}], 
     RowBox[{"8", " ", "A", " ", "per"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"per", ",", "0", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.967192992752248*^9, 3.967193005215283*^9}, {
  3.967196281669379*^9, 3.967196306338566*^9}, {3.96900250262679*^9, 
  3.969002504829347*^9}, {3.969002541289562*^9, 3.969002557407118*^9}, {
  3.971155527868078*^9, 
  3.971155534950552*^9}},ExpressionUUID->"e49f3af0-050b-4526-b28b-\
d4ad01da9587"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.971155537536694*^9, 
  3.971155537539538*^9}},ExpressionUUID->"7e594803-4049-4d14-b61e-\
87972efc4108"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Pe", "[", 
   RowBox[{"per_", ",", "A_", ",", "b_"}], "]"}], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"4", " ", "A", " ", "per", " ", 
     RowBox[{"(", 
      RowBox[{"88200", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2450", "+", 
          RowBox[{"3", " ", "b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1225"}], "+", 
             RowBox[{"461", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox["per", "2"]}]}], ")"}]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1764"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "49"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"]}]}], ")"}], " ", 
        SuperscriptBox["per", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "400"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "25"}], "+", 
          RowBox[{"9", " ", 
           SuperscriptBox["b", "2"]}]}], ")"}], " ", 
        SuperscriptBox["per", "2"]}]}], ")"}]}]], "//", 
   "InputForm"}]}]], "Input",
 CellChangeTimes->{{3.967196329181199*^9, 3.967196339425767*^9}, {
  3.967196445718522*^9, 3.967196447158867*^9}, {3.969005027197331*^9, 
  3.96900503168132*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"fad6badd-3727-4f19-b53e-831d61c69471"],

Cell["\<\
(4*A*per*(88200 + (2450 + 3*b*(-1225 + 461*b))*per^2))/(3*(-1764 + (-49 + \
3*b^2)*per^2)*(-400 + (-25 + 9*b^2)*per^2))\
\>", "Output",
 CellChangeTimes->{3.971155578028808*^9},
 CellLabel->
  "Out[131]//InputForm=",ExpressionUUID->"ef6b4313-16a4-4209-8ea5-\
20446c3225c7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1418, 855},
WindowMargins->{{63, Automatic}, {Automatic, -1094}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9b3b4d0a-1804-49c8-9d37-c8d942922daa"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 580, 13, 357, "Chapter",ExpressionUUID->"6fc8e4dd-4d0d-4d6f-8568-d0e74ea1e545"],
Cell[CellGroupData[{
Cell[1185, 39, 1102, 33, 73, "Input",ExpressionUUID->"03b7beb0-c04c-4985-a583-2c12137d0d6d"],
Cell[2290, 74, 303, 7, 34, "Output",ExpressionUUID->"9b05c7ef-bebf-46c0-8924-6a03fb1e7915"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2630, 86, 4213, 128, 300, "Input",ExpressionUUID->"286f239b-cfe2-422d-a9f7-b6776150bd13"],
Cell[6846, 216, 1564, 47, 49, "Output",ExpressionUUID->"9e057bbf-0533-45f7-9b81-c62ca0412fb5"],
Cell[8413, 265, 1092, 32, 59, "Output",ExpressionUUID->"2c0db9d0-4a22-4776-bebf-d8c4b76cfc8b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9542, 302, 868, 28, 57, "Input",ExpressionUUID->"bdb76d07-9e5f-49ab-be0a-695d34c9f0ca"],
Cell[10413, 332, 870, 28, 59, "Output",ExpressionUUID->"c13a70aa-58cd-411e-b3f3-374218721a45"]
}, Open  ]],
Cell[11298, 363, 153, 3, 30, "Input",ExpressionUUID->"2a9aefcb-8ce6-4ba9-acfc-eb5c05ba2e43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11488, 371, 237, 6, 69, "Chapter",ExpressionUUID->"fdc42be3-76ce-44e5-9c2e-9af1868d4faa"],
Cell[CellGroupData[{
Cell[11750, 381, 2173, 64, 115, "Input",ExpressionUUID->"ded22f65-96f8-4e2d-8c2f-6b3cf4e3d088"],
Cell[13926, 447, 1698, 45, 59, "Output",ExpressionUUID->"f5423acc-7c7c-419d-89e1-35280f10871d"],
Cell[15627, 494, 754, 23, 57, "Output",ExpressionUUID->"02aaa0db-9ef4-4e54-bc0d-2d90f7efbafb"],
Cell[16384, 519, 710, 22, 57, "Output",ExpressionUUID->"496f36fd-bffb-4b35-af92-b19af0d33941"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17131, 546, 1626, 49, 175, "Input",ExpressionUUID->"359c2df2-f60a-46bd-b285-2477c8132eb3"],
Cell[18760, 597, 899, 29, 61, "Output",ExpressionUUID->"970be2d7-4828-4985-8627-8b282f96b0d5"],
Cell[19662, 628, 890, 28, 61, "Output",ExpressionUUID->"56d3b1fb-0d4d-4220-bd94-53fd12f4f019"]
}, Open  ]],
Cell[20567, 659, 240, 8, 81, "Text",ExpressionUUID->"b1853518-378f-4b07-85bc-92c140d1af57"],
Cell[20810, 669, 154, 3, 30, "Input",ExpressionUUID->"834b8f3e-31fd-4499-ae09-54ae8a3485fe"],
Cell[CellGroupData[{
Cell[20989, 676, 2381, 72, 129, "Input",ExpressionUUID->"b3dbe012-dc4e-45c7-8ed7-d8767455d15d"],
Cell[23373, 750, 263, 4, 34, "Output",ExpressionUUID->"6f13eeca-7d2c-4739-bb4a-c6aa350cff00"],
Cell[23639, 756, 999, 31, 61, "Output",ExpressionUUID->"5dfc583c-4083-4249-8ad7-2d8f817bd81f"],
Cell[24641, 789, 999, 31, 61, "Output",ExpressionUUID->"cbd954ff-5cd7-493c-86ee-50f83be5d2d9"],
Cell[25643, 822, 378, 8, 57, "Output",ExpressionUUID->"147e6291-c3fc-49c8-b7a9-95142e9ab389"]
}, Open  ]],
Cell[26036, 833, 184, 3, 35, "Text",ExpressionUUID->"55e4dde9-ba54-413c-a0a5-8d8492e84e64"],
Cell[CellGroupData[{
Cell[26245, 840, 449, 13, 30, "Input",ExpressionUUID->"77db7cf5-47d4-46e1-bda6-75abd30d26ad"],
Cell[26697, 855, 1102, 34, 61, "Output",ExpressionUUID->"5746a029-0d64-453d-a0a1-74f1eac18b7b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27848, 895, 260, 4, 69, "Chapter",ExpressionUUID->"88a14906-b9e7-40ac-b6ab-8284cdbe1d3a"],
Cell[CellGroupData[{
Cell[28133, 903, 7388, 205, 353, "Input",ExpressionUUID->"8c781a94-3767-47fe-ba34-fa35976226ec"],
Cell[35524, 1110, 2031, 50, 60, "Output",ExpressionUUID->"60af0f5d-7b4f-4554-bf4a-b0ec65aef10c"],
Cell[37558, 1162, 2574, 65, 59, "Output",ExpressionUUID->"fec760e9-119c-40fc-a28b-a6d78fc8505a"],
Cell[40135, 1229, 1946, 46, 59, "Output",ExpressionUUID->"7d3c320e-6900-4379-8a54-17229fb79ee9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42118, 1280, 1550, 44, 73, "Input",ExpressionUUID->"267bcc46-0f4a-441d-9562-3a88765d5643"],
Cell[43671, 1326, 398, 10, 34, "Output",ExpressionUUID->"36ba0038-0f7f-425e-88cd-ec7cb691b9b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44106, 1341, 2509, 73, 115, "Input",ExpressionUUID->"8ef67c33-08d2-46ec-a2b1-c00751d0a138"],
Cell[46618, 1416, 2734, 75, 61, "Output",ExpressionUUID->"5fc9000d-035b-47c1-85bc-15ae04909e38"],
Cell[49355, 1493, 1545, 46, 61, "Output",ExpressionUUID->"c410b604-d2e9-42a3-a471-5284c6d5f6d2"],
Cell[50903, 1541, 1462, 43, 61, "Output",ExpressionUUID->"166c631d-8df8-4bf1-8715-a603dfc15d0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52402, 1589, 2046, 63, 152, "Input",ExpressionUUID->"195c06f1-c592-4d5f-8d33-5ab3ed2323c4"],
Cell[54451, 1654, 1424, 43, 61, "Output",ExpressionUUID->"3d0adde3-b1cb-4646-9c65-d535b1945c29"],
Cell[55878, 1699, 1339, 40, 61, "Output",ExpressionUUID->"fd58c17f-4077-4f7a-8ee7-d621b344f32e"]
}, Open  ]],
Cell[57232, 1742, 1163, 33, 122, "Input",ExpressionUUID->"e49f3af0-050b-4526-b28b-d4ad01da9587"],
Cell[58398, 1777, 152, 3, 30, "Input",ExpressionUUID->"7e594803-4049-4d14-b61e-87972efc4108"],
Cell[CellGroupData[{
Cell[58575, 1784, 1433, 44, 59, "Input",ExpressionUUID->"fad6badd-3727-4f19-b53e-831d61c69471"],
Cell[60011, 1830, 283, 7, 48, "Output",ExpressionUUID->"ef6b4313-16a4-4209-8ea5-20446c3225c7"]
}, Open  ]]
}, Open  ]]
}
]
*)

