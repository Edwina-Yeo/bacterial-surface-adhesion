import numpy as np
import matplotlib.pyplot as plt

# update pyplot settings for all plots.
plt.rcParams.update({
"text.usetex": True,
"font.size": 12, "font.family": "serif",
"font.serif": ["Palatino"]})
import math



def calc_flux(Vss,Pers,beta,Vs_val,Dr):

    J=np.zeros(17,)
    sd=np.zeros(17,)

    loc='data_test/'
    for i in range(0,17):
    
        t=np.linspace(300,10300,5)
        x=np.linspace(0.5,3,10)
        Per=Pers[i]
        print(len(x))
        Vs=Vss[i]            
        xb = np.loadtxt(loc+'Vs' + str(Vs) + '-beta-' + str(beta) + '-Per-' + str(Per) + '-xbs.txt')
        tb = np.loadtxt(loc+'Vs' + str(Vs) + '-beta-' + str(beta)+ '-Per-' + str(Per) + '-tbs.txt')
        print(np.shape(tb),np.shape(x))
        H, xedges, yedges = np.histogram2d(xb, tb, bins=(x, t))
        H = H.T
        print(np.shape(H))
        ad_t=np.sum(H,axis=1)
        J[i]=np.mean(ad_t)
        sd[i]=np.std(ad_t)
#        i += 1
    np.savetxt('cp_july/J-Vs'+str(Vs_val)+'-dr-'+str(Dr)+'-beta-'+str(beta)+'.txt',J)

    print(J)
    np.savetxt('cp_july/sd-Vs'+str(Vs_val)+'-dr-'+str(Dr)+'-beta-'+str(beta)+'.txt',sd)


L=750
gam=np.logspace(-1.5,2,20)


# echo "vs=22, dr=1, beta=0.1"

Vs=22
Dr=1
beta=0.1
Vss = [0.927601446982725, 0.537674341844181, 0.311657230395585, 0.180648808579368, 0.104711166173565, 0.0606947170460338, 0.0351810490888042, 0.0203923220212084, 0.0118201932059212, 0.00685144964266435, 0.00397137012806613, 0.00230196257969762, 0.00133430819778777, 0.000773417596960905, 0.000448303308246572, 0.000259854258520291, 0.000150621765284835, 8.73063089545187e-05, 5.06061761316331e-05, 2.93333333333333e-05]
Pers = [0.0316227766016838, 0.0545559478116852, 0.0941204967268067, 0.162377673918872, 0.280135676119887, 0.483293023857175, 0.833782223471789, 1.43844988828766, 2.48162892283682, 4.2813323987194, 7.38619982207936, 12.7427498570313, 21.9839264886229, 37.9269019073225, 65.4318912971297, 112.883789168469, 194.748303990876, 335.981828628378, 579.639395338497, 1000]



#calc_flux(Vss,Pers,beta,Vs,Dr)



# echo "vs=40, dr=2, beta=0.25"


Vs=40
Dr=2
beta=0.25
U=gam*L
#Vss = [1.68654808542314, 0.566649509810155, 0.190383938497390, 0.0639655437978258, 0.0370769491294699, 0.0214912603744021, 0.0124571811684806, 0.00722067296012024, 0.00418538650854113, 0.00242601490506868, 0.00140621381265619, 0.000815096924084677, 0.000472462288218711, 0.000273857755063336]
Pers = [0.0158113883008419, 0.0272779739058426, 0.0470602483634033, 0.0811888369594361, 0.140067838059943, 0.241646511928588, 0.416891111735895, 0.719224944143832, 1.24081446141841, 2.14066619935970, 3.69309991103968, 6.37137492851567, 10.9919632443114, 18.9634509536613, 32.7159456485648, 56.4418945842345, 97.3741519954378, 167.990914314189, 289.819697669249, 500]

Vss=[1.68654808542314, 0.977589712443966, 0.566649509810155, 0.328452379235214, 0.190383938497390, 0.110354030992789, 0.0639655437978258, 0.0370769491294699, 0.0214912603744021 ,0.0124571811684806, 0.00722067296012024 ,0.00418538650854113 ,0.00242601490506868 ,0.00140621381265619, 0.000815096924084677, 0.000472462288218711, 0.000273857755063336, 0.000158738743553670, 9.20112293302421e-05, 5.33333333333333e-05]

#Pers=(0.0158113883008419 0.0272779739058426 0.0470602483634033 0.0811888369594361 0.140067838059943 0.241646511928588 0.416891111735895 0.719224944143832 1.24081446141841 2.14066619935970 3.69309991103968 6.37137492851567 10.9919632443114 18.9634509536613 32.7159456485648 56.4418945842345 97.3741519954378 167.990914314189 289.819697669249 500)


#calc_flux(Vss,Pers,beta,Vs,Dr)
# calc one for supplementary 

beta=0.88
#calc_flux(Vss,Pers,beta,Vs,Dr)
# echo "vs=40, dr=4, beta=0.5"

Vs=40
Dr=4
beta=0.4


#Vss=(1.68654808542314 0.977589712443966 0.566649509810155 0.328452379235214 0.190383938497390 0.110354030992789 0.0639655437978258 0.0370769491294699 0.0214912603744021 0.0124571811684806 0.00722067296012024 0.00418538650854113 0.00242601490506868 0.00140621381265619 0.000815096924084677 0.000472462288218711 0.000273857755063336 0.000158738743553670 9.20112293302421e-05 5.33333333333333e-05)

Pers=[0.00790569415042095 ,0.0136389869529213 ,0.0235301241817017 ,0.0405944184797180 ,0.0700339190299717 ,0.120823255964294, 0.208445555867947, 0.359612472071916, 0.620407230709206, 1.07033309967985 ,1.84654995551984, 3.18568746425783, 5.49598162215572 ,9.48172547683063, 16.3579728242824, 28.2209472921172, 48.6870759977189, 83.9954571570945, 144.909848834624, 250]
Vss=[1.68654808542314,0.977589712443966, 0.566649509810155, 0.328452379235214 ,0.190383938497390, 0.110354030992789 ,0.0639655437978258, 0.0370769491294699 ,0.0214912603744021, 0.0124571811684806, 0.00722067296012024 ,0.00418538650854113, 0.00242601490506868 ,0.00140621381265619, 0.000815096924084677 ,0.000472462288218711 ,0.000273857755063336 ,0.000158738743553670 ,9.20112293302421e-05, 5.33333333333333e-05]
#Pers = [0.00790569415042095, 0.0235301241817017, 0.0700339190299717, 0.208445555867947, 0.359612472071916, 0.620407230709206, 1.07033309967985, 1.84654995551984, 3.18568746425783, 5.49598162215572, 9.48172547683063, 16.3579728242824, 28.2209472921172, 48.687075997718]


calc_flux(Vss,Pers,beta,Vs,Dr)


# echo "vs=22, dr=0.1, beta=0.0"
Vs=22
Dr=0.1
beta=0.0
Vss = [0.927601446982725, 0.537674341844181, 0.311657230395585, 0.180648808579368, 0.104711166173565, 0.0606947170460338, 0.0351810490888042, 0.0203923220212084, 0.0118201932059212, 0.00685144964266435, 0.00397137012806613, 0.00230196257969762, 0.00133430819778777, 0.000773417596960905, 0.000448303308246572, 0.000259854258520291, 0.000150621765284835, 8.73063089545187e-05, 5.06061761316331e-05, 2.93333333333333e-05]
Pers = [0.316227766016838, 0.545559478116852, 0.941204967268067, 1.62377673918872, 2.80135676119887, 4.83293023857175, 8.33782223471789, 14.3844988828766, 24.8162892283683, 42.813323987194, 73.8619982207936, 127.427498570313, 219.839264886229, 379.269019073225, 654.318912971297, 1128.83789168469, 1947.48303990876, 3359.81828628378, 5796.39395338497, 10000]


#calc_flux(Vss,Pers,beta,Vs,Dr)



# echo "vs=70, dr=2, beta=0"

Vs=70
Dr=2
beta=0.0
Vss = [2.95145914949049, 1.71078199677694, 0.991636642167772, 0.574791663661625, 0.333171892370433, 0.19311955423738, 0.111939701646195, 0.0648846609765723, 0.0376097056552038, 0.0218000670448411, 0.0126361776802104, 0.00732442638994697, 0.00424552608387019, 0.00246087417214833, 0.00142641961714818, 0.000826809004382743, 0.000479251071360838, 0.000277792801218923, 0.000161019651327924, 9.33333333333333e-05]
Pers = [0.0158113883008419, 0.0272779739058426, 0.0470602483634033, 0.0811888369594361, 0.140067838059943, 0.241646511928588, 0.416891111735895, 0.719224944143832, 1.24081446141841, 2.1406661993597, 3.69309991103968, 6.37137492851567, 10.9919632443114, 18.9634509536613, 32.7159456485648, 56.4418945842345, 97.3741519954378, 167.990914314189, 289.819697669249, 500]



#calc_flux(Vss,Pers,beta,Vs,Dr)


# echo "vs=10, dr=0.5, beta=0.0"
Vs=10
Dr=0.5
beta=0.0
Vss = [0.421637021355784, 0.244397428110991, 0.141662377452539, 0.0821130948088035, 0.0475959846243475, 0.0275885077481972, 0.0159913859494565, 0.00926923728236748, 0.00537281509360054, 0.00311429529212016, 0.00180516824003006, 0.00104634662713528, 0.000606503726267170, 0.000351553453164048, 0.000203774231021169, 0.000118115572054678, 6.84644387658341e-05, 3.96846858884176e-05, 2.30028073325605e-05, 1.33333333333333e-05]
Pers = [0.0632455532033676, 0.109111895623370, 0.188240993453613, 0.324755347837744, 0.560271352239774, 0.966586047714350, 1.66756444694358, 2.87689977657533, 4.96325784567365, 8.56266479743879, 14.7723996441587, 25.4854997140627, 43.9678529772458, 75.8538038146450, 130.863782594259, 225.767578336938, 389.496607981751, 671.963657256756, 1159.27879067699, 2000]


#calc_flux(Vss,Pers,beta,Vs,Dr)



J=17
# Arrays with normal spacing between elements
import numpy as np

Vs=6
Dr=5
beta=0.0
Pers = np.array([
    0.00632455532033676, 0.0109111895623370, 0.0188240993453613, 0.0324755347837744,
    0.0560271352239774, 0.0966586047714350, 0.166756444694358, 0.287689977657533,
    0.496325784567365, 0.856266479743879, 1.47723996441587, 2.54854997140627,
    4.39678529772458, 7.58538038146450, 13.0863782594259, 22.5767578336938,
    38.9496607981751, 67.1963657256756, 115.927879067699, 200
])
Vss = np.array([
    0.252982212813470, 0.146638456866595, 0.0849974264715233, 0.0492678568852821,
    0.0285575907746085, 0.0165531046489183, 0.00959483156967387, 0.00556154236942048,
    0.00322368905616032, 0.00186857717527210, 0.00108310094401804, 0.000627807976281169,
    0.000363902235760302, 0.000210932071898429, 0.000122264538612702,"7.08693432328066e-5",
    "4.10786632595004e-5", 2.38108115330506e-05, 1.38016843995363e-05, 8.00000000000000e-06
])

#echo "vs=6, dr=5, beta=0.0"
#calc_flux(Vss,Pers,beta,Vs,Dr)

#echo "vs=6, dr=5, beta=0.0"
Vs=100
Dr=1
beta=0.0
Vss = np.array([
    4.21637021355784, 2.44397428110991, 1.41662377452539, 0.821130948088035,
    0.475959846243475, 0.275885077481972, 0.159913859494565, 0.0926923728236747,
    0.0537281509360054, 0.0311429529212016, 0.0180516824003006, 0.0104634662713528,
    0.00606503726267170, 0.00351553453164048, 0.00203774231021169, 0.00118115572054678,
    0.000684644387658341, 0.000396846858884176, 0.000230028073325605, 0.000133333333333333
])

Pers = np.array([
    0.0316227766016838, 0.0545559478116852, 0.0941204967268067, 0.162377673918872,
    0.280135676119887, 0.483293023857175, 0.833782223471789, 1.43844988828766,
    2.48162892283683, 4.28133239871940, 7.38619982207936, 12.7427498570313,
    21.9839264886229, 37.9269019073225, 65.4318912971297, 112.883789168469,
    194.748303990876, 335.981828628378, 579.639395338497, 1000
])

#echo "vs=100, dr=1, beta=0.0"

#calc_flux(Vss,Pers,beta,Vs,Dr)

